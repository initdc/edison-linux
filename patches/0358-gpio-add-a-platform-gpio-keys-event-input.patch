From 0f663a6816bddb75a2178ea34003a7e1d59acd33 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Lo=C3=AFc=20Akue?= <loicx.akue@intel.com>
Date: Wed, 13 Aug 2014 19:12:32 +0200
Subject: [PATCH 358/429] gpio: add a platform-gpio-keys-event input
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Let's provide a sysfs interface to catch event triggered
by the Arduino's board RM button.

Signed-off-by: Lo√Øc Akue <loicx.akue@intel.com>
---
 .../device_libs/platform_gpio_keys.c          | 31 +++++++++++--------
 1 file changed, 18 insertions(+), 13 deletions(-)

diff --git a/arch/x86/platform/intel-mid/device_libs/platform_gpio_keys.c b/arch/x86/platform/intel-mid/device_libs/platform_gpio_keys.c
index 5f56e8014589..395e051153b4 100644
--- a/arch/x86/platform/intel-mid/device_libs/platform_gpio_keys.c
+++ b/arch/x86/platform/intel-mid/device_libs/platform_gpio_keys.c
@@ -25,18 +25,24 @@
  * buttons here, we will shrink them if no GPIO found.
  */
 static struct gpio_keys_button gpio_button[] = {
-	{KEY_POWER,		-1, 1, "power_btn",	EV_KEY, 0, 3000},
-	{KEY_PROG1,		-1, 1, "prog_btn1",	EV_KEY, 0, 20},
-	{KEY_PROG2,		-1, 1, "prog_btn2",	EV_KEY, 0, 20},
-	{SW_LID,		-1, 1, "lid_switch",	EV_SW,  0, 20},
-	{KEY_VOLUMEUP,		-1, 1, "vol_up",	EV_KEY, 0, 20},
-	{KEY_VOLUMEDOWN,	-1, 1, "vol_down",	EV_KEY, 0, 20},
-	{KEY_CAMERA,		-1, 1, "camera_full",	EV_KEY, 0, 20},
-	{KEY_CAMERA_FOCUS,	-1, 1, "camera_half",	EV_KEY, 0, 20},
-	{SW_KEYPAD_SLIDE,	-1, 1, "MagSw1",	EV_SW,  0, 20},
-	{SW_KEYPAD_SLIDE,	-1, 1, "MagSw2",	EV_SW,  0, 20},
-	{KEY_CAMERA,		-1, 1, "cam_capture",	EV_KEY, 0, 20},
-	{KEY_CAMERA_FOCUS,	-1, 1, "cam_focus",	EV_KEY, 0, 20},
+        {
+                .code = KEY_POWER,
+                .gpio = -1, /* GPIO number */
+                .active_low = 1,
+                .desc = "power_btn",/*Button description*/
+                .type = EV_KEY,
+                .wakeup = 0,
+                .debounce_interval = 3000,
+        },
+        {
+		.code = KEY_PROG1,
+		.gpio = 61,
+		.active_low = 1,
+		.desc = "SW1UI4",
+		.type = EV_KEY,
+		.wakeup = 0,
+		.debounce_interval = 50,
+        },
 };
 
 static struct gpio_keys_platform_data gpio_keys = {
@@ -64,7 +70,6 @@ static int __init pb_keys_init(void)
 
 	num = sizeof(gpio_button) / sizeof(struct gpio_keys_button);
 	for (i = 0; i < num; i++) {
-		gb[i].gpio = get_gpio_by_name(gb[i].desc);
 		pr_info("info[%2d]: name = %s, gpio = %d\n",
 			 i, gb[i].desc, gb[i].gpio);
 		if (gb[i].gpio == -1)
-- 
2.37.3

